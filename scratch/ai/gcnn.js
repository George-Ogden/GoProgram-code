class Genetic_Convolutional_Neural_Network extends Genetic_Neural_Network{constructor(t,e,r,n="swish"){super("Genetic_Convolutional_Neural_Network",n),this.length=r,this.width=t,this.height=e,this.weights=[],this.biases=[],this.kernels=[];for(let n=0;n<r;n++)this.kernels.push(Matrix.multiply(new Matrix(e,t),2/t**2))}copy(){return Genetic_Convolutional_Neural_Network.from_string(JSON.parse(JSON.stringify(this)))}mutate(t=.1){let e=this.copy();for(let r=0;r<this.length;r++)e.kernels[r].map(e=>Math.random()<t?e+2*Math.random()-1:e);return e}static crossover(t,e,r=.5){t=t.copy(),e=e.copy();for(let n=0;n<t.length;n++)t.kernels[n].set(t.kernels[n].map((t,e)=>Math.random()<r?t:e,e.kernels[n]));return t.mutate(.02)}static from_string(t){let e=new Genetic_Convolutional_Neural_Network(t.width,t.height,t.length,t.activation_function_name);for(let r=0;r<e.length;r++)e.kernels[r]=Matrix.fromArray(t.kernels[r].data);return e}forward_propagate(t){let e=t.copy();for(let t=0;t<this.length;t++)e.set(Matrix.map(Convoluting.convolution(e,this.kernels[t]),this.activation_function.function));return e}}