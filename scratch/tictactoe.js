let move_promise,thinking=!1;const size=5,umpire=new Noughts_and_Crosses(5,4),pieces={0:".",1:"X","-1":"O",".":0,X:1,O:-1},player={move:async function(e,o){w=e.rss()%2*2-1;let n=await this.request(Matrix.flatten(e).data[0].map(e=>pieces[e]).join(""));if(200==n.status)return Matrix.multiply(Matrix.resize(Matrix.fromArray([n.responseText.toUpperCase().split("").map(e=>pieces[e])]),5,5),w)},request:function(e){return new Promise(function(o,n){let t=new XMLHttpRequest;t.open("GET",`https://api.goprogram.ai/games/tictactoe?board=${e}`),t.onload=function(){200==this.status&&o(t)},t.send()})}};function endGame(){finishMove(),thinking=!0,umpire.find()}function finishMove(){thinking=!1,$(".cover").addClass("d-none"),$(".cover").removeClass("darken d-flex")}async function displayBoard(e){for(let o=0;o<e.rows;o++)for(let n=0;n<e.cols;n++){let t=e.data[o][n];0!=t&&($(`[row=${o}][col=${n}].box circle`).css({background:t<0?"red":"blue",opacity:1}),$(`[row=${o}][col=${n}].box`).css("background","var(--primary-light)"),$(`[row=${o}][col=${n}].box`).hasClass("taken")||$(`[row=${o}][col=${n}].box`).addClass("taken"))}}async function animateMove(){}function resize(){$("#board").height($("#board").width())}start=()=>$("body").off("mouseenter"),$("section").off("scroll"),umpire.challenge(player),$("body").on("mouseenter",start),$("section").on("scroll",function(){$("section").height()-$("table#board").offset().top>50&&start()}),$(window).resize(resize),resize(),$("td.box").on("mouseover",function(){thinking||$(this).is(".taken")||($(this).css("background","var(--primary-dark)"),$(this).children("circle").css({opacity:"0.3",background:"red"}))}),$("td.box").on("mouseout",function(){thinking||$(this).is(".taken")||($(this).css("background","var(--primary-light)"),$(this).children("circle").css("background","transparent"))}),$("td.box").on("click",function(){thinking||$(this).is(".taken")||(thinking=!0,$(".cover").removeClass("d-none"),$(".cover").addClass("darken d-flex"),$(".box:not(.taken) circle").css("background","transparent"),$(".box").css("background","var(--primary-light)"),move_promise([$(this).attr("row"),$(this).attr("col")]))});