const GSL_DBL_EPSILON=2.220446049250313e-16,one_over_E=1/Math.E;function halley_iteration(e,r,t){let a,s=r;for(a=0;a<t;a++){let r,t=Math.exp(s),u=s+1,l=s*t-e;if(s>0?l=l/u/t:l/=t*u-.5*(u+1)*l/u,s-=l,r=GSL_DBL_EPSILON*Math.max(Math.abs(s),1/(Math.abs(u)*t)),Math.abs(l)<r)return{value:s,error:2*r,iters:a,success:!0}}return{value:s,error:Math.abs(s),iters:a,success:!1}}function series_eval(e){const r=[-1,2.331643981597124,-1.8121878856393634,1.9366311144923598,-2.3535512018816145,3.0668589010506317,-4.175335600258177,5.858023729874774,-8.401032217523978,12.25075350131446,-18.10069701247244,27.029044799010563];return r[0]+e*(r[1]+e*(r[2]+e*(r[3]+e*(r[4]+e*(r[5]+e*(r[6]+e*(r[7]+e*(r[8]+e*(r[9]+e*(r[10]+e*r[11]))))))))))}function lambert_W0_e(e){const r=e+1/Math.E;let t={};if(0==e)return t.value=0,t.error=0,t.success=!0,t;if(r<0)return t.value=-1,t.error=Math.sqrt(-r),t.success=!1,t;if(0==r)return t.value=-1,t.error=GSL_DBL_EPSILON,t.success=!0,t;if(r<.001){const e=Math.sqrt(r);return t.value=series_eval(e),t.error=2*GSL_DBL_EPSILON*Math.abs(t.value),t.success=!0,t}{const a=100;let s;if(e<1){const e=Math.sqrt(2*Math.E*r);s=e*(1+e*(-1/3+11*e/72))-1}else s=Math.log(e),e>3&&(s-=Math.log(s));return halley_iteration(e,s,a,t)}}function lambert_Wm1_e(e){let r={};if(e>0)return lambert_W0_e(e);if(0==e)return r.value=0,r.error=0,r.success=!0,r;{const t=32,a=e+1/Math.E;let s;if(a<0)return r.value=-1,r.error=Math.sqrt(-a),r.success=!1,r;if(e<-1e-6){if(s=series_eval(-Math.sqrt(a)),a<.003)return r.value=s,r.error=5*GSL_DBL_EPSILON*Math.abs(s),r.success=!0,r}else{const r=Math.log(-e),t=Math.log(-r);s=r-t+t/r}return halley_iteration(e,s,t)}}function lambert_W0(e){return lambert_W0_e(e).value}function lambert_Wm1(e){return lambert_Wm1_e(e).value}