class square{constructor(t,a){this._value=$("#_"+t+a).val()?Number($("#_"+t+a).val()):0,this._isConstant=!!$("#_"+t+a).val(),this.x=t,this.y=a}get value(){return this._value}set value(t){this._value=this.isConstant?this._value:t%10}get isConstant(){return this._isConstant}set isConstant(t){this._isConstant=t}}class Sudoku{constructor(){this.data=[]}check_data(){for(let t=0;t<9;t++)for(let a=0;a<9;a++)try{let e=$("#_"+t+a).val();if(!e)continue;if((e=parseInt(e))%1!=0||e>9||e<0)throw"";$("#_"+t+a)[0].setCustomValidity("")}catch(s){return $("#valid").show(),$("#_"+t+a)[0].setCustomValidity("Invalid Input!"),!1}return!0}get_data(){for(let t=0;t<9;t++){this.data.push([]);for(let a=0;a<9;a++)this.data[t].push(new square(t,a))}for(var e=0;e<9;e++)for(var s=0;s<9;s++)if(!(Sudoku.difference(this.data[e])&&Sudoku.difference(this.data.map(t=>t[s]))&&Sudoku.difference(this.data.filter(t=>Math.floor(this.data.indexOf(t)/3)==Math.floor(e/3)).map(t=>t.filter(a=>Math.floor(t.indexOf(a)/3)==Math.floor(s/3))),2)))return $("#valid").show(),this.data=[],!1;return!0}set_data(){for(let t=0;t<9;t++)for(let a=0;a<9;a++)$("#_"+t+a).val(this.data[t][a].value),this.data[t][a].isConstant||$("#_"+t+a).css("background","var(--secondary-light)")}print(){let t=[];for(let a=0;a<9;a++)for(let e=0;e<9;e++)t.push(this.data[a][e].value)}static difference(t,a=1){if(2==a){let e=[];for(let s=0;s<t.length;s++)for(let i=0;i<t.length;i++)e.push(t[s][i]);t=e}for(let r=0;r<t.length;r++)for(let o=0;o<t.length;o++)if(r!=o&&t[r].value==t[o].value&&0!=t[r].value&&0!=t[o].value)return!1;return!0}async solve(){$("#solve").hide();try{for(var t=0;t<9;t++)for(var a=0;a<9;)if(await new Promise(t=>setTimeout(t,0)),this.currentData=this.data[t][a],this.currentData.value||(this.currentData.value=1,$("#_"+t+a).css("background","var(--secondary-light)"),$("#_"+t+a).val(1)),Sudoku.difference(this.data[t])&&Sudoku.difference(this.data.map(t=>t[a]))&&Sudoku.difference(this.data.filter(a=>Math.floor(this.data.indexOf(a)/3)==Math.floor(t/3)).map(t=>t.filter(e=>Math.floor(t.indexOf(e)/3)==Math.floor(a/3))),2))$("#_"+t+a).val(this.currentData.value||""),a++;else if(this.currentData.isConstant&&0==a)a=8,t--;else if(this.currentData.isConstant)a--;else if(9==this.currentData.value){for($("#_"+t+a).val(""),this.currentData.value=0;$("#_"+t+a).css("background","var(--secondary-dark)"),this.data[t][a].isConstant&&$("#_"+t+a).val(""),0==a?(a=8,t--):a--,this.data[t][a].isConstant||9==this.data[t][a].value++;);$("#_"+t+a).css("background","var(--secondary-light)"),$("#_"+t+a).val(this.currentData.value||"")}else this.currentData.value++,$("#_"+t+a).css("background","var(--secondary-light)"),$("#_"+t+a).val(this.currentData.value||"");this.set_data(),solve=!1,$("#solve").hide(),$("#solve").show(),$("#solve").html("Reset")}catch(e){$("#solve").show(),$("#valid").html("INVALID SUDOKU"),$("#solve").html("Solve"),this.data=[]}}reset(){for(let t=0;t<9;t++)for(let a=0;a<9;a++)this.data[t][a].isConstant||$("#_"+t+a).val(""),$("#_"+t+a).css("background","var(--secondary-dark)")}}let solve=!0,sudoku=new Sudoku;function run(){$("#valid").hide(),solve?sudoku.check_data()&&sudoku.get_data()&&sudoku.solve():(sudoku.reset(),$("#solve").html("Solve"),sudoku=new Sudoku,solve=!0)}function resize(){$("#sudoku").height($("#sudoku").width())}$("#solve").click(function(t){t.preventDefault(),run()}),$("#sudoku").change(sudoku.check_data),$("input").on("input",function(){if($(this).val().match(/^[0-9]$/)){let t=$("#_"+(8>parseInt($(this).attr("id").slice(1,3))?"0":"")+(parseInt($(this).attr("id").slice(1,3))+(8==$(this).attr("id")[2]?2:1)));t&&t.focus()}}),$(window).resize(resize),resize();