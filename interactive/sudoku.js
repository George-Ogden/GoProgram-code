class square{constructor(a,b){this._value=$("#_"+a+b).val()?Number($("#_"+a+b).val()):0,this._isConstant=!!$("#_"+a+b).val(),this.x=a,this.y=b}get value(){return this._value}set value(a){this._value=this.isConstant?this._value:a%10}get isConstant(){return this._isConstant}set isConstant(a){this._isConstant=a}}class Sudoku{constructor(){this.data=[]}check_data(){for(let a=0;a<9;a++)for(let b=0;b<9;b++)try{let c=$("#_"+a+b).val();if(!c)continue;if((c=parseInt(c))%1!=0||c>9||c<0)throw"";$("#_"+a+b)[0].setCustomValidity("")}catch(d){return $("#valid").show(),$("#_"+a+b)[0].setCustomValidity("Invalid Input!"),!1}return!0}get_data(){for(let a=0;a<9;a++){this.data.push([]);for(let b=0;b<9;b++)this.data[a].push(new square(a,b))}for(var c=0;c<9;c++)for(var d=0;d<9;d++)if(!(Sudoku.difference(this.data[c])&&Sudoku.difference(this.data.map(a=>a[d]))&&Sudoku.difference(this.data.filter(a=>Math.floor(this.data.indexOf(a)/3)==Math.floor(c/3)).map(a=>a.filter(b=>Math.floor(a.indexOf(b)/3)==Math.floor(d/3))),2)))return $("#valid").show(),this.data=[],!1;return!0}set_data(){for(let a=0;a<9;a++)for(let b=0;b<9;b++)$("#_"+a+b).val(this.data[a][b].value),this.data[a][b].isConstant||$("#_"+a+b).css("background","var(--secondary-light)")}print(){let c=[];for(let a=0;a<9;a++)for(let b=0;b<9;b++)c.push(this.data[a][b].value)}static difference(a,g=1){if(2==g){let f=[];for(let d=0;d<a.length;d++)for(let e=0;e<a.length;e++)f.push(a[d][e]);a=f}for(let b=0;b<a.length;b++)for(let c=0;c<a.length;c++)if(b!=c&&a[b].value==a[c].value&&0!=a[b].value&&0!=a[c].value)return!1;return!0}async solve(){$("#solve").hide();try{for(var b=0;b<9;b++)for(var a=0;a<9;)if(await new Promise(a=>setTimeout(a,0)),this.currentData=this.data[b][a],this.currentData.value||(this.currentData.value=1,$("#_"+b+a).css("background","var(--secondary-light)"),$("#_"+b+a).val(1)),Sudoku.difference(this.data[b])&&Sudoku.difference(this.data.map(b=>b[a]))&&Sudoku.difference(this.data.filter(a=>Math.floor(this.data.indexOf(a)/3)==Math.floor(b/3)).map(b=>b.filter(c=>Math.floor(b.indexOf(c)/3)==Math.floor(a/3))),2))$("#_"+b+a).val(this.currentData.value||""),a++;else if(this.currentData.isConstant&&0==a)a=8,b--;else if(this.currentData.isConstant)a--;else if(9==this.currentData.value){for($("#_"+b+a).val(""),this.currentData.value=0;$("#_"+b+a).css("background","var(--primary-light)"),this.data[b][a].isConstant&&$("#_"+b+a).val(""),0==a?(a=8,b--):a--,this.data[b][a].isConstant||9==this.data[b][a].value++;);$("#_"+b+a).css("background","var(--secondary-light)"),$("#_"+b+a).val(this.currentData.value||"")}else this.currentData.value++,$("#_"+b+a).css("background","var(--secondary-light)"),$("#_"+b+a).val(this.currentData.value||"");this.set_data(),solve=!1,$("#solve").hide(),$("#solve").show(),$("#solve").html("Reset")}catch(c){$("#solve").show(),$("#valid").html("INVALID SUDOKU"),$("#solve").html("Solve"),this.data=[]}}reset(){for(let a=0;a<9;a++)for(let b=0;b<9;b++)this.data[a][b].isConstant||$("#_"+a+b).val(""),$("#_"+a+b).css("background","var(--primary-light)")}}let solve=!0,sudoku=new Sudoku;function run(){$("#valid").hide(),solve?sudoku.check_data()&&sudoku.get_data()&&sudoku.solve():(sudoku.reset(),$("#solve").html("Solve"),sudoku=new Sudoku,solve=!0)}function resize(){$("#sudoku").height($("#sudoku").width())}$("#solve").click(function(a){a.preventDefault(),run()}),$("#sudoku").change(sudoku.check_data),$("input").on("input",function(){if($(this).val().match(/^[0-9]$/)){let a=$("#_"+(8>parseInt($(this).attr("id").slice(1,3))?"0":"")+(parseInt($(this).attr("id").slice(1,3))+(8==$(this).attr("id")[2]?2:1)));a&&a.focus()}}),$(window).resize(resize),resize()